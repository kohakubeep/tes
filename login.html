<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Login | Warung Bunda Sri</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

<style>
*{
  margin:0;
  padding:0;
  box-sizing:border-box;
}

body{
  font-family:'Inter',sans-serif;
  background:#f5f7fa;
  min-height:100vh;
  display:flex;
  align-items:center;
  justify-content:center;
  padding:20px;
}

.login-container{
  max-width:420px;
  width:100%;
  background:#ffffff;
  border-radius:16px;
  padding:40px;
  box-shadow:0 4px 20px rgba(0,0,0,.1);
}

.logo-section{
  text-align:center;
  margin-bottom:35px;
}

.logo{
  font-size:48px;
  margin-bottom:15px;
}

h2{
  font-size:26px;
  font-weight:700;
  color:#333;
  margin-bottom:8px;
}

.subtitle{
  color:#666;
  font-size:14px;
}

.mode-selector{
  display:flex;
  gap:10px;
  margin-bottom:25px;
  background:#f8f9fa;
  padding:5px;
  border-radius:12px;
}

.mode-btn{
  flex:1;
  padding:12px;
  border:none;
  background:transparent;
  border-radius:8px;
  font-weight:600;
  color:#666;
  cursor:pointer;
  transition:all .3s ease;
}

.mode-btn.active{
  background:#ff5722;
  color:#fff;
  box-shadow:0 2px 8px rgba(255,87,34,.3);
}

.form-group{
  margin-bottom:20px;
}

.form-label{
  display:block;
  font-weight:600;
  color:#333;
  margin-bottom:8px;
  font-size:14px;
}

.form-control{
  width:100%;
  padding:12px 16px;
  border:2px solid #e1e8ed;
  border-radius:8px;
  font-size:15px;
  font-family:'Inter',sans-serif;
  transition:border-color .3s ease;
}

.form-control:focus{
  outline:none;
  border-color:#ff5722;
}

.btn-login{
  width:100%;
  background:#ff5722;
  color:#fff;
  padding:14px;
  border:none;
  border-radius:8px;
  font-weight:600;
  font-size:15px;
  cursor:pointer;
  transition:background .3s ease;
  margin-top:10px;
}

.btn-login:hover{
  background:#e64a19;
}

.btn-login:disabled{
  background:#ccc;
  cursor:not-allowed;
}

.divider{
  text-align:center;
  margin:25px 0;
  position:relative;
  color:#999;
  font-size:13px;
}

.divider::before{
  content:'';
  position:absolute;
  left:0;
  top:50%;
  width:100%;
  height:1px;
  background:#e1e8ed;
}

.divider span{
  background:#fff;
  padding:0 15px;
  position:relative;
  z-index:1;
}

.btn-guest{
  width:100%;
  background:transparent;
  color:#666;
  padding:12px;
  border:2px solid #e1e8ed;
  border-radius:8px;
  font-weight:600;
  font-size:14px;
  cursor:pointer;
  transition:all .3s ease;
}

.btn-guest:hover{
  border-color:#ff5722;
  color:#ff5722;
}

.alert{
  padding:12px;
  border-radius:8px;
  margin-bottom:20px;
  font-size:14px;
}

.alert-danger{
  background:#fee;
  color:#c33;
  border:1px solid #fcc;
}

.alert-success{
  background:#efe;
  color:#393;
  border:1px solid #cfc;
}

.alert-info{
  background:#eff;
  color:#369;
  border:1px solid #cee;
}

.small-text{
  text-align:center;
  margin-top:20px;
  font-size:12px;
  color:#999;
}

.admin-info{
  background:#fff3cd;
  border:1px solid #ffe69c;
  padding:12px;
  border-radius:8px;
  margin-bottom:20px;
  font-size:13px;
  color:#856404;
}

.admin-info strong{
  display:block;
  margin-bottom:5px;
}

@media (max-width:576px){
  .login-container{
    padding:30px 25px;
  }
  
  h2{
    font-size:22px;
  }
}
</style>
</head>

<body>

<div class="login-container">
  
  <div class="logo-section">
    <div class="logo">üçΩÔ∏è</div>
    <h2>Selamat Datang</h2>
    <p class="subtitle">Warung Bunda Sri</p>
  </div>

  <!-- MODE SELECTOR -->
  <div class="mode-selector">
    <button class="mode-btn active" onclick="switchMode('user')">
      üë§ User
    </button>
    <button class="mode-btn" onclick="switchMode('admin')">
      üîê Admin
    </button>
  </div>

  <div id="alertBox"></div>

  <!-- USER LOGIN FORM -->
  <form id="userForm" onsubmit="handleUserLogin(event)">
    
    <div class="form-group">
      <label class="form-label">Nama Lengkap</label>
      <input 
        type="text" 
        class="form-control" 
        id="nama" 
        placeholder="Masukkan nama Anda"
        required
      >
    </div>

    <div class="form-group">
      <label class="form-label">Nomor Telepon</label>
      <input 
        type="tel" 
        class="form-control" 
        id="telepon" 
        placeholder="08xxxxxxxxxx"
        pattern="[0-9]{10,13}"
        required
      >
    </div>

    <button type="submit" class="btn-login" id="btnUserLogin">
      Masuk
    </button>

    <div class="divider">
      <span>ATAU</span>
    </div>

    <button type="button" class="btn-guest" onclick="masukSebagaiTamu()">
      Lanjutkan sebagai Tamu
    </button>

  </form>

  <!-- ADMIN LOGIN FORM -->
  <form id="adminForm" onsubmit="handleAdminLogin(event)" style="display:none;">
    

    <div class="form-group">
      <label class="form-label">Username</label>
      <input 
        type="text" 
        class="form-control" 
        id="adminUsername" 
        placeholder="Masukkan username"
        required
      >
    </div>

    <div class="form-group">
      <label class="form-label">Password</label>
      <input 
        type="password" 
        class="form-control" 
        id="adminPassword" 
        placeholder="Masukkan password"
        required
      >
    </div>

    <button type="submit" class="btn-login" id="btnAdminLogin">
      üîê Login Admin
    </button>

  </form>

  <div class="small-text">
    Dengan masuk, Anda menyetujui syarat & ketentuan kami
  </div>

</div>

<script>
let currentMode = 'user';

// Check if already logged in
window.addEventListener('DOMContentLoaded', () => {
  const currentUser = localStorage.getItem('currentUser');
  const adminSession = localStorage.getItem('adminSession');
  
  if(adminSession){
    window.location.href = 'ADMIN.html';
  } else if(currentUser){
    window.location.href = 'HOME.html';
  }
});

function switchMode(mode){
  currentMode = mode;
  
  // Update button states
  document.querySelectorAll('.mode-btn').forEach(btn => {
    btn.classList.remove('active');
  });
  event.target.classList.add('active');
  
  // Toggle forms
  if(mode === 'user'){
    document.getElementById('userForm').style.display = 'block';
    document.getElementById('adminForm').style.display = 'none';
  } else {
    document.getElementById('userForm').style.display = 'none';
    document.getElementById('adminForm').style.display = 'block';
  }
  
  // Clear alert
  document.getElementById('alertBox').innerHTML = '';
}

function handleUserLogin(e){
  e.preventDefault();
  
  const nama = document.getElementById('nama').value.trim();
  const telepon = document.getElementById('telepon').value.trim();
  const btnLogin = document.getElementById('btnUserLogin');
  
  // Validation
  if(!nama || !telepon){
    showAlert('Mohon lengkapi semua data!', 'danger');
    return;
  }
  
  if(telepon.length < 10){
    showAlert('Nomor telepon tidak valid!', 'danger');
    return;
  }
  
  // Show loading
  btnLogin.innerHTML = 'Memproses...';
  btnLogin.disabled = true;
  
  setTimeout(() => {
    // Save user data
    const userData = {
      nama: nama,
      telepon: telepon,
      loginTime: new Date().toLocaleString('id-ID'),
      status: 'active'
    };
    
    // Save to localStorage
    localStorage.setItem('currentUser', JSON.stringify(userData));
    
    // Save to users history
    saveToUsersHistory(userData);
    
    // Show success and redirect
    showAlert('Login berhasil! Selamat datang, ' + nama, 'success');
    
    setTimeout(() => {
      window.location.href = 'HOME.html';
    }, 1000);
  }, 1000);
}

function handleAdminLogin(e){
  e.preventDefault();
  
  const username = document.getElementById('adminUsername').value.trim();
  const password = document.getElementById('adminPassword').value.trim();
  const btnLogin = document.getElementById('btnAdminLogin');
  
  // Admin credentials
  const ADMIN_USERNAME = 'admin';
  const ADMIN_PASSWORD = 'admin123';
  
  // Show loading
  btnLogin.innerHTML = 'Memverifikasi...';
  btnLogin.disabled = true;
  
  setTimeout(() => {
    if(username === ADMIN_USERNAME && password === ADMIN_PASSWORD){
      // Save admin session
      const adminData = {
        username: username,
        loginTime: new Date().toLocaleString('id-ID'),
        role: 'admin'
      };
      
      localStorage.setItem('adminSession', JSON.stringify(adminData));
      
      showAlert('Login admin berhasil! Mengalihkan...', 'success');
      
      setTimeout(() => {
        window.location.href = 'ADMIN.html';
      }, 1000);
    } else {
      showAlert('Username atau password salah!', 'danger');
      btnLogin.innerHTML = 'üîê Login Admin';
      btnLogin.disabled = false;
    }
  }, 1000);
}

function saveToUsersHistory(userData){
  const users = JSON.parse(localStorage.getItem('users')) || [];
  
  // Check if user exists
  const existingUserIndex = users.findIndex(u => u.telepon === userData.telepon);
  
  if(existingUserIndex !== -1){
    // Update existing user
    users[existingUserIndex] = {
      ...users[existingUserIndex],
      nama: userData.nama,
      lastLogin: userData.loginTime,
      loginCount: (users[existingUserIndex].loginCount || 0) + 1
    };
  } else {
    // Add new user
    users.push({
      ...userData,
      id: 'USER-' + Date.now(),
      loginCount: 1,
      registeredAt: userData.loginTime
    });
  }
  
  localStorage.setItem('users', JSON.stringify(users));
}

function masukSebagaiTamu(){
  const guestData = {
    nama: 'Tamu',
    telepon: '-',
    loginTime: new Date().toLocaleString('id-ID'),
    status: 'guest'
  };
  
  localStorage.setItem('currentUser', JSON.stringify(guestData));
  
  showAlert('Melanjutkan sebagai tamu...', 'info');
  
  setTimeout(() => {
    window.location.href = 'HOME.html';
  }, 800);
}

function showAlert(message, type){
  const alertBox = document.getElementById('alertBox');
  const alertClass = type === 'success' ? 'alert-success' : 
                     type === 'danger' ? 'alert-danger' : 
                     'alert-info';
  
  alertBox.innerHTML = `
    <div class="alert ${alertClass}">
      ${message}
    </div>
  `;
  
  setTimeout(() => {
    alertBox.innerHTML = '';
  }, 5000);
}

// Auto-format phone number
document.getElementById('telepon').addEventListener('input', function(e){
  this.value = this.value.replace(/[^0-9]/g, '');
});
</script>

</body>
</html>
